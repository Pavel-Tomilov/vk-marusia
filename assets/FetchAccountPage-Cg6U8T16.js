import{r as s,j as e,L as a,A as t,a as i,q as c,h as n,f as r,k as l,S as _,B as o,m as d}from"./index-DiawIBuO.js";import{u as m,E as u}from"./ErrorMessage-C6u2BIwH.js";import{C as x}from"./CardMovie-jVF-5XPe.js";import{S as j}from"./favorite-RHeJvmZr.js";const h="AccountPage-module__account__5R87c",v="AccountPage-module__account__container__zUqCx",N="AccountPage-module__account__title__hBJ-7",p="AccountPage-module__account__list__oHn3q",f="AccountPage-module__account__icon__LAM8R",g="AccountPage-module__tab__text_short__swFb0",y="AccountPage-module__tab__text__Kuw5F",S="Favorites-module__favorites__list__yKq5f",b="Favorites-module__favorites__item__9V6tH",C="Favorites-module__favorites__delete__GaTen",k="Favorites-module__favorites__link__hsScD",q="Favorites-module__favorites__wrapper__U56zN",F=({initialMovies:i})=>{const[c,n]=s.useState(i);return e.jsx("div",{className:q,children:e.jsx("ul",{className:S,children:c.map((s=>e.jsxs("li",{className:b,children:[e.jsx(a,{to:`/movie/${s.id}`,className:`movie__link ${k}`,"aria-label":`Перейти к информации о фильме ${s.title}`,children:e.jsx(x,{data:s,account:!0})}),e.jsx("button",{className:C,onClick:()=>(async s=>{try{await t.deleteFavorites(s),n((e=>e.filter((e=>e.id!==s))))}catch(e){}})(s.id),"aria-label":"Удалить фильм из избранного",children:"×"})]},s.id)))})})},A=({favoriteIds:s})=>{const a=m({queryFn:async()=>await Promise.all(s.map((s=>t.getMovieById(Number(s))))),queryKey:["favorites",s]},c);switch(a.status){case"pending":return e.jsx(i,{});case"success":return e.jsx(F,{initialMovies:a.data});case"error":return e.jsx(u,{onRetry:()=>a.refetch()})}},w="Settings-module__settings__list__a-tf4",M="Settings-module__settings__item__GLIDq",P="Settings-module__settings__subtitle__xCqGx",U="Settings-module__settings__data__ckQ-0",$="Settings-module__settings__icon__4xxZ8",I="Settings-module__settings__wrapper__QC4OS";function K(s,e){var a,t;const i=s.trim(),c=e.trim();return((null==(a=i[0])?void 0:a.toUpperCase())||"")+((null==(t=c[0])?void 0:t.toUpperCase())||"")}const R=({data:s})=>{const{setUserName:a}=n(),i=r();return e.jsxs("div",{className:I,children:[e.jsxs("ul",{className:w,children:[e.jsxs("li",{className:M,children:[e.jsx("span",{className:$,children:K(s.name,s.surname)}),e.jsxs("div",{children:[e.jsx("span",{className:P,children:"Имя Фамилия"}),e.jsx("p",{className:U,children:`${l(s.name)} ${l(s.surname)}`})]})]}),e.jsxs("li",{className:M,children:[e.jsx("span",{className:$,children:e.jsx(_,{})}),e.jsxs("div",{children:[e.jsx("span",{className:P,children:"Электронная почта"}),e.jsx("p",{className:U,children:s.email})]})]})]}),e.jsx(o,{text:"Выйти из аккаунта",onClick:()=>{try{t.logoutUser(),a(null),i("/")}catch(s){}}})]})},B=({account:a})=>{const t=s.useMemo((()=>e.jsx(j,{})),[]),i=s.useMemo((()=>e.jsx(d,{})),[]),[c,n]=s.useState("favorites"),r=s=>{n(s)};return e.jsx("section",{className:h,children:e.jsxs("div",{className:`container ${v}`,children:[e.jsx("h2",{className:N,children:"Мой аккаунт"}),e.jsx("nav",{children:e.jsxs("ul",{className:p,children:[e.jsx("li",{children:e.jsxs("a",{className:"tab__link "+("favorites"===c?"active":""),onClick:()=>r("favorites"),children:[e.jsx("span",{className:f,children:t}),e.jsx("span",{className:y,children:"Избранные фильмы"}),e.jsx("span",{className:g,children:"Избранное"})]})}),e.jsx("li",{children:e.jsxs("a",{className:"tab__link "+("settings"===c?"active":""),onClick:()=>r("settings"),"data-short-label":"Избранное",children:[e.jsx("span",{className:f,children:i}),e.jsx("span",{className:y,children:"Настройка аккаунта"}),e.jsx("span",{className:g,children:"Настройки"})]})})]})}),"favorites"===c?e.jsx(A,{favoriteIds:a.favorites}):e.jsx(R,{data:a})]})})},G=()=>{const s=m({queryFn:()=>t.fetchUser(),queryKey:["user"]},c);switch(s.status){case"pending":return e.jsx(i,{});case"success":return e.jsx(B,{account:s.data});case"error":return e.jsx(u,{onRetry:()=>s.refetch()})}};export{G as default};
