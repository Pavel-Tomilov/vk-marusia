import{r as e,A as s,j as n,L as t,k as r,B as i,l as a,a as o,q as l}from"./index-DiawIBuO.js";import{u as c,E as _}from"./ErrorMessage-C6u2BIwH.js";import{C as d}from"./CardMovie-jVF-5XPe.js";const g={genre:"MoviesByGenrePage-module__genre__zFZD1",genre__container:"MoviesByGenrePage-module__genre__container__jimML",genre__title:"MoviesByGenrePage-module__genre__title__1w--E",genre__list:"MoviesByGenrePage-module__genre__list__Vw1s0",genre__btn_up:"MoviesByGenrePage-module__genre__btn_up__3yW3y"},m=({initialMovies:a,genre:o})=>{const[l,c]=e.useState(a),[_,m]=e.useState(l.slice(0,10)),[u,v]=e.useState(1),[h,w]=e.useState(!1),[y,j]=e.useState(!0),[x,p]=e.useState(!1),b=e.useCallback((async()=>{if(!h&&y){w(!0);try{const e=u+1,n=await s.getMoviesByGenre(o,e);0===n.length?j(!1):(c((e=>[...e,...n])),m((e=>[...e,...n.slice(0,10)])),v(e))}catch(e){}finally{w(!1)}}}),[u,o,h,y]),M=e.useCallback((()=>{const e=l.slice(_.length,_.length+10);e.length<10&&y&&b(),m((s=>[...s,...e]))}),[l,_,y,b,h]);e.useEffect((()=>{requestAnimationFrame((()=>{const e=document.documentElement.scrollHeight-200-window.innerHeight;window.scrollTo({top:e,behavior:"smooth"})}))}),[_]);return e.useEffect((()=>{const e=()=>{const e=document.documentElement.scrollHeight>window.innerHeight;p(e)};return e(),window.addEventListener("resize",e),window.addEventListener("scroll",e),()=>{window.removeEventListener("resize",e),window.removeEventListener("scroll",e)}}),[]),n.jsx("section",{className:g.genre,children:n.jsxs("div",{className:`container ${g.genre__container}`,children:[n.jsx(t,{to:"/movie/genres",className:g.genre__title,"aria-label":"Перейти к странице со списком жанров",children:r(`${o}`)}),n.jsx("ul",{className:g.genre__list,children:_.map((e=>n.jsx("li",{className:g.genre__item,children:n.jsx(t,{to:`/movie/${e.id}`,className:"movie__link","aria-label":`Перейти к информации о фильме ${e.title}`,children:n.jsx(d,{data:e})})},e.id)))}),y&&n.jsx(i,{text:h?"Загрузка...":"Показать ещё",onClick:M,disabled:h,"aria-label":"Показать еще фильмы этого жанра"}),x&&n.jsx("div",{className:g.genre__btn_up,children:n.jsx(i,{text:"Back to Top",type:"grey",onClick:()=>{window.scrollTo({top:0,behavior:"smooth"})},"aria-label":"Вернуться на верх страницы"})})]})})},u=()=>{const[e]=a(),t=e.get("genre")||"",r=c({queryFn:()=>s.getMoviesByGenre(t,1),queryKey:["moviesByGenre",t]},l);switch(r.status){case"pending":return n.jsx(o,{});case"success":return n.jsx(m,{initialMovies:r.data,genre:t});case"error":return n.jsx(_,{onRetry:()=>r.refetch()})}};export{u as default};
